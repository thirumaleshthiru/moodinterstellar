-- Users table
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    profile_pic LONGBLOB,
    role ENUM('user', 'admin') NOT NULL DEFAULT 'user',
    pending_verification BOOLEAN DEFAULT FALSE,
    milestone INT DEFAULT 30,
    current_position INT DEFAULT 0,
    mental_score_percentage INT DEFAULT 0,
    is_reset BOOLEAN DEFAULT FALSE,
    followers INT DEFAULT 0,
    following INT DEFAULT 0,     
    total_likes INT DEFAULT 0,
    last_task_date DATE DEFAULT NULL,
    profession ENUM('student','employee') NOT NULL,
    is_surevy_completed BOOLEAN DEFAULT FALSE
);

-- Tasks table
CREATE TABLE tasks (
    id INT AUTO_INCREMENT PRIMARY KEY,
    task_name VARCHAR(255) NOT NULL,
    task_description TEXT NOT NULL,
    task_output TEXT NOT NULL,
    task_recommendation_start INT NOT NULL,
    task_recommendation_end INT NOT NULL,
    people_who_completed INT DEFAULT 0
);

-- Stories table
CREATE TABLE stories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    story_title VARCHAR(255) NOT NULL,
    story_content TEXT NOT NULL,
    story_cover_image LONGBLOB,
    story_category INT NOT NULL,
    story_tags INT NOT NULL,
    likes INT DEFAULT 0,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (story_category) REFERENCES categories(id) ON DELETE CASCADE,
    FOREIGN KEY (story_tags) REFERENCES tags(id) ON DELETE CASCADE
);

 

 

-- Beginning Questions table
CREATE TABLE beginning_questions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    question TEXT NOT NULL,
    options JSON NOT NULL,
    preference DECIMAL(3,2) NOT NULL
);

-- Journey Questions table
CREATE TABLE journey_questions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    question TEXT NOT NULL,
    options JSON NOT NULL,
    preference DECIMAL(3,2) NOT NULL
);

-- Followers table
CREATE TABLE followers (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    follower_id INT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (follower_id) REFERENCES users(id) ON DELETE CASCADE
);

-- Following table
CREATE TABLE following (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    following_id INT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (following_id) REFERENCES users(id) ON DELETE CASCADE
);

-- Categories table
CREATE TABLE categories (
    id INT AUTO_INCREMENT PRIMARY KEY,
    category_name VARCHAR(255) NOT NULL
);

-- Tags table
CREATE TABLE tags (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tag_name VARCHAR(255) NOT NULL
);

-- Likes table
CREATE TABLE likes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    story_id INT NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (story_id) REFERENCES stories(id) ON DELETE CASCADE
);
 
create table delete_reasons(
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    reason TEXT NOT NULl,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
)


-- User Performance Statistics table
CREATE TABLE user_performance_statistics (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    date DATE NOT NULL,
    tasks_completed INT DEFAULT 0,
    mental_score INT DEFAULT 0,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- User Performance Statistics table
CREATE TABLE keywords (
    id INT AUTO_INCREMENT PRIMARY KEY,
    recomend_percent_start int not null,
    recomend_percent_end not null
    keyword varchar(60)
);
